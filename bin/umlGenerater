#!/usr/bin/env php
<?php

use UmlGenerator\UmlGenerator;

if (is_file(__DIR__ . '/../vendor/autoload.php')) {
    require_once __DIR__ . '/../vendor/autoload.php';
} else if (is_file(__DIR__ . '/../../../autoload.php')) {
    require_once __DIR__ . '/../../../autoload.php';
} else if (is_file(__DIR__ . '/../autoload.php')) {
    require_once __DIR__ . '/../autoload.php';
}

$umlGenerator = new UmlGenerator();

if (!file_exists('uml')) {
	mkdir('uml' , 0755);
}

if (1 === count($argv)) {
	exit(1);
}

unset($argv[0]);
foreach ($argv as $className) {
	if (!class_exists($className)) {
		echo $className . 'クラスが存在しません。';
		exit(1);
	}
}
foreach ($umlGenerator->generate($argv) as $umlTemplate) {
	file_put_contents('uml/' . $umlTemplate->getFileName() . '.dot', $umlTemplate->getTemplate());
}
